### 명령어 사이클과 인터럽트

- 명령어 사이클

  - CPU는 명령어를 하나씩 실행한다.
    이때 프로그램속 각각의 명령어들은 일정한 주기가 반복되며 실행되는데 이 주기를 '명령어 사이클' 이라고한다. (인출 사이클과 실행 사이클을 반복함)

  - 인출 사이클

    - 메모리에 있는 명령어를 CPU로 가지고오는 단계.

  - 실행 사이클

    - CPU로 명령어를 인출한후 명령어를 실행하는 단계.
    - 제어장치가 명령어 레지스터에 담긴 명령어를 해석하고 제어 신호를 발생시키는 단계.

  - 간접 사이클
    - CPU로 명령어를 가져왔다 하더라도 이 명령어가 메모리의 주소일 경우 즉, 간접 주소 지정 방식 일경우 바로 실행하지 못하고 메모리에 또 다시 접근해야한다.

- 인터럽트 (interrupt)

  - CPU가 수행중인 작업은 방해를 받아 잠시 중단될 수 있다.
    이 CPU의 작업을 방해하는 신호를 인터럽트 라고 한다.

  - 동기 인터럽트 (예외)

    - CPU에 의해 발생하는 인터럽트이다.
      CPU가 명령어를 수행하다가 예상치 못한 상황에 마주쳣을때, 즉 프로그래밍상의 오류와 같은 예외적인 상황에 마주쳣을때 발생하는 인터럽트.
    - 동기 인터럽트는 "예외"라고 불리기도 한다.

  - 비동기 인터럽트 (하드웨어 인터럽트)
    - 주로 입출력 장치에서 일어나는 인터럽트이다.
      입출력장치의 작업을 부탁하면 작업을 끝낸 입출력장치가 CPU에 완료 알림(인터럽트)를 보낸다.
    - ex) 프린트 작업을 요청한 후 작업이 완료되면 완료알림 인터럽트를 보낸다.
    - 처리순서
      1. 입출력장치는 CPU에 "인터럽트 요청 신호"를 보낸다.
      2. CPU는 실행 사이클이 끝나고 명령어를 인출하기 전 항상 인터럽트 여부를 확인한다.
      3. CPU는 인터럽트 요청을 확인하고 "인터럽트 플래그"를 통해 현재 인터럽트를 받아들일 수 있는지 여부를 확인한다.
      4. 인터럽트를 받아들일 수 있다면 CPU는 지금까지의 일을 백업한다.
      5. CPU는 "인터럽트 벡터"를 참조하여 "인터럽트 서비스 루틴"을 실행한다.
      6. 인터럽트 서비스루틴 실행이 끝나면 4에서 백업해둔 작업을 복구하여 실행을 재개한다.

- 용어

  - 인터럽트 요청 신호

    - 인터럽트는 CPU의 정상적인 실행흐름을 끊는것이기에 다른 누군가가 인터럽트 하기전에는 지금 실행 시켜줄수 있나 CPU에게 물어봐야한다. 이것을 인터럽트 요청 신호 라고 한다.

  - 인터럽트 플래그

    - CPU가 인터럽트 요청을 수용하기 위해서는 플래그 레지스터의 인터럽트 플래그가 활성화 되어있어야 한다.
    - 하지만 인터럽트 플래그가 불가능으로 설정되어 있다고 해서 모든 인터럽트를 막을수 있는것은 아니다. 하드웨어 인터럽트는 가장 우선순위가 높은 작업은 무조건 실행을 한다. (정전, 하드웨어 고장)

  - 인터럽트 서비스 루틴

    - 인터럽트를 처리하기 위한 프로그램으로 "인터럽트 핸들러" 라고도 불린다.
    - 예를들어 '키보드가 어떤 인터럽트 요청을 보냈을 때는 어떻게 작동한다' 와 같은 어떤 인터럽트가 발생했을 때 해당 인터럽트를 어떻게 처리하고 작동해야 할지에 대한 정보로 이루어진 프로그램이다.

  - 인터럽트 벡터
    - 각기다른 인터럽트 서비스 루틴을 구분하기 위한 정보.
      인터럽트 벡터를 알면 인터럽트 서비스 루틴의 시작 주소를 알 수 있어 인터럽트 서비스 루틴을 처음부터 실행할 수 있다.

- CPU가 인터럽트를 처리한다라는 말은 인터럽트 서비스 루틴을 실행하고, 본래 수행하던(백업)햇던 작업으로 다시 되돌아온다 라는말이다. 그리고 CPU가 인터럽트 서비스 루틴을 실행하려면 인터럽트 벡터를 통해 인터럽트 서비스 루틴의 시작 주소를 찾아서 실행할 수 있다.
