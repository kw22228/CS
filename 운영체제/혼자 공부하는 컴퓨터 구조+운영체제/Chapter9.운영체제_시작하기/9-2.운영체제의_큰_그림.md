### 운영체제의 큰 그림

- 커널 이란?

  - 운영체제의 심장 이라고 불린다.
  - 자원에 접근하고 조작하고, 프로그램이 안전하게 실행되게 하는 기능을 핵심 서비스라고한다.
    즉, 이 핵심 서비스를 담당하는 부분을 "커널"이라고 한다.

- 이중모드와 시스템 호출

  - 이중모드
    - CPU가 명령어를 실행하는 모드를 크게 사용자 모드와 커널모드로 구분하는 방식. (CPU의 모드가 무슨 모드인지는 플래그 레지스터속 슈퍼바이저 플래그로 참고한다.)
    - 사용자모드
      - 운영체제 서비스를 제공 받을 수 없는 실행 모드이다.
    - 커널모드
      - 운영체제 서비스를 제공받을 수 있는 실행 모드이다.
  - 시스템 호출(시스템 콜)
    - 사용자 모드인 응용 프로그램이 자원에 접근하기 위해서는 운영체제에 요청을 보내 커널모드로 전환되어야 한다.
      이때 운영체제의 서비스를 받기위한 요청을 시스템 호출 이라고 한다.
    - 이 시스템 호출을 처리하는 순서는 인터럽트 처리 순서와 비슷하다. 따라서, 소프트웨어 인터럽트 라고 한다.
      시스템 호출 발생 -> CPU는 지금까지 일을 백업 -> 커널 영역내 시스템 호출을 수행하는코드(인터럽트 서비스 루틴)을 실행함 -> 다시 프로그램 복귀하여 실행

- 시스템 콜 작동 예시

  - 한 응용 프로그램이 하드 디스크에 데이터를 저장 하려고한다.

  1. 사용자 모드로 실행되는 동안에는 자원에 접근할 수 없기 때문에 커널 모드로 전환해야한다.
     따라서, 응용프로그램은 하드디스크에 데이터를 저장하는 "시스템 호출"을 발생시켜 커널모드로 전환한다.
  2. 운영체제 내의 하드 디스크에 데이터를 저장하는 코드를 실행하여 하드디스크에 접근한다.
  3. 하드디스크에 데이터를 저장.
  4. 다시 사용자 모드로 복귀하여 실행을 계속 해 나간다.

- 운영체제의 핵심 서비스

  - 프로세스 관리

    - 운영체제는 다양한 프로세스를 관리하고 실행한다.

  - 자원접근 및 할당

    - 모든 프로세스는 실행을 위해 자원을 필요로 한다.
      운영체제는 이러한 프로세스들이 사용할 자원에 접근하고 조작함으로써 프로세스에 필요한 자원을 할당한다.
    - CPU
      - 하나의 CPU는 한번에 하나의 프로세스만 실행 가능하다.
        때문에 운영체제는 프로세스들에 공정하게 CPU를 할당하기 위해 어떤 프로세스를 할당할 것인지, 얼마나 오래 할당할 것인지를 결정한다.
        이를 "CPU 스케줄링" 이라고 한다.
    - 메모리
      - 메모리에 적재된 프로세스들은 크기도, 주소도 가지각색이다.
        운영체제는 새로운 프로세스가 적재될 때마다 어느 주소에 적재해야 할지를 결정한다.
        때로는 메모리가 꽉차있어 꼭 실행해야 할 프로세스를 적재할 공간이 없는 경우, 메모리에 공간이 있는데도 프로세스를 적재하지 못하는 상황도 있다.
    - 입출력 장치
      - 인터럽트 서비스 루틴은 운영체제가 제공하는 기능으로 "커널"영역에 있다.
        따라서 입출력 장치가 발생시키는 하드웨어 인터럽트도 커널영역에 인터럽트 서비스루틴을 실행한다.

  - 파일 시스템 분리
    - 컴퓨터를 사용할 때 여러 파일을 열고, 생성하고, 삭제하는데 이러한 파일들을 디렉토리로 관리한다.
      이런 파일 시스템도 운영체제가 지원하는 핵심 서비스이다.
