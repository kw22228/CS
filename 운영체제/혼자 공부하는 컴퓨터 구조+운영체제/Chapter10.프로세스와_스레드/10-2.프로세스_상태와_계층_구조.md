### 프로세스 상태와 계층 구조

- 프로세스 상태

  - 생성 상태

    - 프로세스를 생성중인 상태를 생성 상태(new)라고 한다. 즉, 이제 막 메모리에 적재되어 PCB를 할당받은 상태이다.
      생성 상태가 된 이후로는 실행할 준비가 완료된 준비 상태가 된다.

  - 준비 상태

    - 지금 당장이라도 CPU를 할당받아 실행할 수 있는 상태이다. 하지만 아직 자신의 차례가 아니기에 기다리고 있는 상태이다.
      준비상태에서 CPU할당 차례가 되어 CPU를 할당 받으면 실행 상태가 된다.
    - 준비 상태 -> 실행 상태로 전환되는 것을 디스패치(dispatch)라고 한다.

  - 실행 상태

    - CPU를 할당받아 실행중인 상태이다. 실행 상태인 프로세스는 할당된 일정 시간 동안만 CPU를 사용할 수 있다.
      할당된 시간을 모두 사용하면(타이머 인터럽트가 발생하면) 다시 "준비 상태"가 되고,
      실행 도중 입출력장치를 사용하여 입출력 장치의 작업이 끝날 때까지 기다려야 한다면 "대기 상태"가 된다.

  - 대기 상태

    - 프로세스는 실행 중에 입출력장치를 사용하는 경우가 있다. 프로세스는 이 입출력장치의 입출력이 끝날 때까지 기다려야한다.
      이렇게 입출력장치의 작업을 기다리는 상태를 "대기 상태" 라고 한다.
      입출력 장치의 작업이 완료되면 해당 프로세스는 다시 "준비 상태"로 CPU할당을 기다린다.

  - 종료 상태
    - 프로세스가 종료된 상태이다. 프로세스가 종료되면 운영체제는 PCB와 프로세스가 사용한 메모리를 정리한다.

- 프로세스 계층 구조

  - 프로세스는 실행 도중 시스템 콜을 통해 다른 프로세스를 생성할 수 있다.
    이때 새 프로세스를 생성한 프로세스를 "부모 프로세스", 새로 생성된 프로세스를 "자식 프로세스" 라고 한다.
    이 부모와 자식 프로세스는 아예 다른 프로세스 이기 때문에 각기 다른 PID를 가지고 있다. (자식 프로세스는 PPID로 기록되는 운영체제도 있다.)

  - 이 자식 프로세스는 또다른 자식 프로세스를 생성할 수 있는데 이러한 프로세스의 트리 형태의 구조를 "프로세스 계층 구조" 라고 한다.

  - 예시: 컴퓨터 부팅(최초 프로세스) -> 컴퓨터 로그인 프로세스(부팅 프로세스의 자식 프로세스) -> bash 셀 프로세스(로그인 프로세스의 자식 프로세스) -> Vim 프로세스 (bash 셀 프로세스의 자식 프로세스)

- 프로세스 생성 기법

  - 부모 프로세스는 "fork"를 통해 자신의 복사본을 자식 프로세스로 생성해 내고,
    만들어진 복사본(자식 프로세스)는 "exec"을 통해 자신의 메모리 공간을 다른 프로그램으로 교체한다.

  - fork와 exec

    - fork와 exec은 둘다 시스템 콜이다.
    - fork
      - 자기 자신 프로세스의 복사본을 만드는 시스템 콜이다.
    - exec
      - 자신의 메모리공간을 새로운 프로그램으로 덮어쓰는 시스템 콜이다.
        즉, 새로운 프로그램 내용으로 전환하여 설명하는 시스템 콜임.

  - flow
    - 부모 프로세스가 fork -> 부모 프로세스의 복제본인 자식 프로세스 생성 -> 자식 프로세스 exec -> 자식 프로세스가 새로운 프로세스로 덮어 씌워짐
