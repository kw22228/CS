### 프로세스 개요

- 프로세스란?

  - 실행 중인 프로그램을 "프로세스" 라고 한다.
    실행되기 전의 프로그램은 단순히 보조기억장치에 있는 데이터 덩어리일 뿐이지만,
    보조기억장치에 저장된 프로그램을 메모리에 적재하고 실행하는 순간 프로세스가 된다.

- 프로세스 종류

  - 프로세스 중에는 사용자가 실행한 프로세스 외에도 알 수 없는 프로세스가 실행되고 있는걸 볼 수 있다.
    이중에서 사용자가 볼 수 있는 공간에서 실행되는 프로세스를 "포그라운드 프로세스" 라고 하고
    사용자가 볼 수 없는 공간에서 실행되는 프로세스를 "백그라운드 프로세스" 라고 한다.

  - 백그라운드 프로세스
    - 이 백그라운드 프로세스 중에서는 사용자와 직접 상호작용할 수 있는 프로세스도 있지만,
      상호작용하지 않고 묵묵히 정해진 일만 하는 프로세스도 있다.
      이러한 프로세스를 유닉스에서는 "데몬" 이라고 하고 윈도우에서는 "서비스" 라고 한다.

- 프로세스 제어 블록 (PCB)

  - CPU는 하나의 프로세스만 실행할 수 있기 때문에 여러 프로세스를 번갈아가며 할당한다고 했다.
    이 프로세스들을 번갈아가며 CPU를 분배하기 위해 운영체제는 프로세스 제어 블록을 이용한다.

  - 동작 플로우

    - CPU는 프로세스를 할당한다 -> 시간이 끝났음을 알리는 인터럽트(타이머 인터럽트)가 발생한다 -> 실행하던 프로세스를 뒤로넘기고 다음 프로세스를 할당한다

  - PCB에 담기는 정보

    - 프로세스 ID (PID)

      - 특정 프로세스를 식별하기 위한 고유한 번호.
        같은 일을 수행하는 프로그램이라 해도 두번 실행하면 PID가 다른 두개의 프로세스가 생성된다.

    - 레지스터 값

      - 프로세스는 자신의 실행 차례가 돌아오면 이전까지 사용했던 레지스터의 중간값들을 복원한다.
        PCB안에는 해당 프로세스가 실행하며 사용했던 프로그램 카운터를 비롯한 레지스터 값들이 담긴다.

    - 프로세스 상태

      - 현재 프로세스의 상태를 기록한다.
        현재 프로세스가 입출력장치를 사용하기 위해 기다리고 있는 상태인지,
        CPU를 사용하기 위해 기다리고 있는 상태인지, CPU를 이용하고 있는 상태인지 등의 상태정보가 담긴다.

    - CPU 스케줄링 정보

      - 프로세스가 언제, 어떤 순서로 CPU를 할당받을지에 대한 정보

    - 메모리 관리 정보

      - 프로세스마다 메모리에 저장된 위치가 다르다. 따라서, PCB에는 프로세스가 어느 주소에 저장되어 있는지에 대한 정보가 담긴다.
        베이스 레지스터, 한계 레지스터 값과 같은 정보가 담긴다.

    - 사용한 파일과 입출력장치 목록
      - 프로세스가 실행하는데 있어서 특정 입출력장치나 파일을 사용한다면 PCB에 해당 내용이 명시된다.
        즉, 어떤 입출력장치가 할당되었는지, 어떤 파일들을 열었는지에 대한 정보들이 담긴다.

- 문맥 교환

  - 문맥이란?
    - CPU 스케줄링에 의해 실행중이던 프로세스가 다음 프로세스로 CPU를 양도할 때, 지금까지의 중간 정보를 백업해야한다.
      이러한 중간 정보, 즉 프로세스 수행을 재개하기 위해 기억해야 할 정보를 "문맥"이라고 한다. (PCB에 담기는 정보를 문맥이라고 봐도 무방)
  - 이처럼 CPU가 할당하는 프로세스가 변화할때 문맥 교환이 이루어진다.
  - 문맥교환 플로우
    - 프로세스 A 실행 -> 프로세스 A의 문맥을 PCB에 저장 -> 프로세스 B의 문맥을 PCB로 부터 가져옴 -> 프로세스 B 실행 -> 프로세스 B의 문맥 PCB에 저장 -> 프로세스 A문맥 가져옴 -> ....

- 프로세스의 메모리 영역

  - 정적 할당 영역

    - 코드 영역 (텍스트 영역)
      - 실행할 수 있는 코드, 즉 기계어로 이루어진 명령어가 저장된다. (읽기 전용의 공간)
    - 데이터 영역
      - 프로그램이 실행되는 동안 유지할 데이터가 저장되는 공간이다. (전역 변수같은것)

  - 동적 할당 영역

    - 힙 영역
      - 프로그래머가 직접 할당할 수 있는 저장 공간이다.
        힙영역에 메모리공간을 할당했다면 언젠가는 해당 공간을 반환해야한다. 반환하지 않는다면 메모리 내에 계속 할당한 공간이 남아 메모리 누수가 발생한다.
    - 스택 영역
      - 데이터를 일시적으로 저장하는 공간이다. (휘발성)
        함수의 실행이 끝나면 사라지는 매개 변수, 지역 변수가 대표적이다.
