### HTTP에서의 전달 구조

#### 1.HTTP 메세지

- HTTP란?

  - HTML등의 텍스트 파일이나 이미지 등의 콘텐츠를 전달하기 위해 사용하는 프로토콜이다.
  - 초창기에는 텍스트 정보만 송신하는 단순한 프로토콜이엿다.

- 요청과 응답
  - 클라이언트인 웹브라우저가 요청을 보내고, 서버인 웹서버가 그 요청에 대한 응답을 반환한다.
  - 기본적으로 1요청 1응답을 한다.

#### 2.HTTP 요청과 응답

- HTTP 요청

  - 요청 행, 메세지 헤더, 메세지 바디 이렇게 세 부분으로 나눌 수 있다.
  - 기능
    - 요청 행: 웹서버에 대해 어떤 처리를 하기 원하는지에 대한 요청 내용을 기술한다. (정보를 얻고싶다. , 정보를 수신하고 싶다.)
    - 메세지 헤더: 웹브라우저의 종류나 버전, 대응하는 데이터 형식 등 부가적인 정보를 기술 한다.
    - 메세지 바디: 웹페이지 안의 폼 등에 입력한 텍스트 데이터 등을 웹서버에 보내는 목적으로 사용.

- HTTP 응답
  - 상태 행, 메세지 헤더, 메세지 바디 이렇게 세 부분으로 나눌 수 있다.
  - 기능
    - 상태 행: 클라이언트로부터 받은 HTTP요청에 대해 웹서버 안에서의 처리 결과를 전달한다.
    - 메세지 헤더: 웹서버의 종류나 송신하는 데이터의 형식 등 부가적인 정보를 기술한다.
    - 메세지 바디: 웹브라우저로부터 요청된 HTML등의 데이터가 저장된다.

#### 3.HTTP 메서드

- 메서드 종류

  - GET: HTML파일 등 콘텐츠를 얻고 싶을때
  - POST: 데이터를 웹서버에 전달할 때
  - PUT: 웹서버가 보관하고 있는 콘텐츠를 수정하거나 삭제할 때
  - DELETE: 웹사이트 조작의 위험성이 있어 웹서버 측에서 대부분 사용할 수 없도록 한다.

- GET vs POST
  - 두 메서드 다 데이터를 송신할 수 있지만, 그 방법이 다르다.
  - GET은 URL뒤에 QUERY STRING을 붙여 데이터를 보낸다. 요청 행의 url에 붙인다. (보낸 데이터가 노출 될 수 있고, URL에 글자 수 제한이 있는 브라우저(edge)에서는 긴 데이터는 보낼 수 없다.)
  - POST는 HTTP요청 안의 메세지 바디 안에 데이터를 포함시켜 보낸다. (보낸 데이터가 HTTP 바디에 숨겨지고, 큰 데이터를 보낼 수 있다.)

#### 4.상태 코드

- HTTP 요청에 대한 웹서버 안에서의 처리 결과가 HTTP 응답에 포함된다. 이것이 상태 코드이다.
- 100번 ~ 500번대 까지 다섯 종류로 구분된다.
- 상태코드 분류
  - 100번대: HTTP 요청을 처리하고 있음을 알린다. 웹서버가 데이터를 받을 수 있는지 확인하기 위한 일시적인 응답으로 사용.
  - 200번대: HTTP 요청을 정상적으로 처리하였음을 알린다. 웹브라우저 상에서 웹사이트가 정상적으로 표시된경우는 대부분 이 상태 코드가 반환된다.
  - 300번대: HTTP 요청에 대해 전송 처리 등의 웹브라우저 측에서 추가 처리가 필요함을 알린다. 웹사이트의 URL이 변경된 경우 사용
  - 400번대: 클라이언트(브라우저)의 에러임을 알린다. 요청된 HTML 파일등이 웹서버에 존재하지 않을때 반환한다.
  - 500번대: 웹서버에서 에러가 났을경우 발생한다. 웹서버가 무언가의 에러에 의해 요청에 응답할 수 없거나 높은 부하 상태로 인해 일시적으로 웹 콘텐츠를 전송할 수 없는 경우 반환.

#### 6.TCP를 통한 데이터 통신

- TCP에서는 먼저 클라이언트와 서버가 서로 통신할 수 있는 상황인지 확인하고, 커넥션이라 불리는 통신 경로를 확립한다.
  그 후에 데이터를 전달한다.
- 커넥션 확립 과정 (3핸드셰이킹)
  - 클라이언트로부터의 연결 요청(SYN)
    - 클라이언트로부터 서버로 연결을 요청하기 위해 SYN패킷이라 불리는 데이터를 보낸다.
      SYN패킷을 받은 서버는 그에 대해 응답한다.
  - 클라이언트에게 확인 응답 및 서버로부터의 연결 요청(SYN + ACK)
    - TCP는 신뢰성이 있는 통신을 하기 위해 데이터를 송신하고 반드시 상대로부터 확인응답을 받아야 데이터 송신이 완료된것으로 간주한다.
      이 확인 응답이 ACK패킷 이다. 클라이언트로부터의 연결 요청에 대해 서버가 ACK 패킷을 송신함으로써, 연결 가능함을 전달한다.
  - 서버에 확인 응답(ACK)
    - 서버로부터의 연결 요청에 대해 클라이언트는 ACK패킷을 송신한다.
      이렇게 서로 SYN패킷을 보내고 ACK패킷으로 응답함으로써 양방향에서 통신이 가능한 것을 확인하고, 커넥션 확립을 완료한다.

#### 7.HTTP/1.1의 통신

- HTTP 킵 얼라이브

  - 원래 HTTP요청을 송신할 때 TCP에 대해 커넥션을 확립하고 웹서버가 HTTP 응답으로서 데이터를 전달하는 단계에서 커넥션을 닫는 방식을 사용했다.
    그렇기 때문에 웹페이지 안에 이미지가 있는 경우, 커넥션 확립후 페이지를 받은후 커넥션 끊고 다시 커넥션 연결후 이미지 받고 커넥션 닫고 이런 방법을 사용했다.
  - 그래서 HTTP/1.1에서부터는 HTTP 킵 얼라이브 기능이 생겼고 이것으로이해 응답을 받은후에도 커넥션을 유지하는 방법을 사용되었다.

- HTTP 파이프라인
  - HTTP를 순차적으로 여러 HTTP요청을 송신하게 하기 위한 방법.
  - HTTP/2.0 부터는 멀티플렉싱 기술로 여러개의 HTTP요청을 할 수 있음.
