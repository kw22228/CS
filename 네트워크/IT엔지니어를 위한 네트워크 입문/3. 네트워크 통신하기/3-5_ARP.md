### ARP

- 상대방의 MAC 주소를 알아내기 위해 사용되는 프로토콜이다.

#### ARP란?

- 데이터 통신을 위해 2계층 물리적 주소인 MAC 주소와 3계층 논리적 주소인 IP 주소 두개가 사용된다.
  IP 주소 체계는 물리적 MAC 주소와 전혀 연관성이 없으므로 두개의 주소를 연계시켜 주기 위한 메커니즘이 필요한데
  이때 사용되는 프로토콜이 ARP다.

- 호스트에서 아무 통신이 없다가 처음 통신을 시도하자마자 패킷을 캡슐화 하는것은 불가능하다.
  출발지와 목적지 IP 주소는 알고 있지만, 상대방의 MAC주소를 알지 못하니 캡슐화 할수 없기 때문.
  그래서 ARP 브로드캐스트로 상대방의 MAC주소를 얻어와야 한다.

#### ARP 동작

- 동작
  1. 상대 서버의 MAC주소가 필요하기 때문에 ARP 요청을 네트워크에 뿌린다
  2. 2계층 목적지 주소가 브로드캐스트이므로 이 ARP 패킷은 같은 네트워크 안에 있는 모든 단말에 보내진다.
  3. 모든 단말은 ARP 프로토콜 내용을 확인하고 [프로토콜 필드의 대상자 IP]가 자신이 아니면 ARP 패킷을 버린다.
  4. 자신의 IP라면 ARP 요청을 처리하고 응답을 보낸다. (이때 송신자와 대상자의 위치가 바뀐다.)
  5. ARP 요청의 응답을 받고 자신의 ARP 캐시 테이블에 갱신한다. (상대 서버와의 통신이 없을 때까지 유지한다.)
  6. 캐시 테이블이 갱신되 후 상대방의 MAC주소를 알고 있으므로 도착지 MAC주소 필드를 완성해 ping 패킷을 보낸다.

#### GARP 와 RARP

- 일반적인 ARP 외에도 ARP 프로토콜 필드를 그대로 사용하지만 내용을 변경해 원래 ARP 프로토콜의 목저과 다른 용도로 사용하는 GARP, RARP와 같은 프로토콜이 있다.
- 대상자 IP 필드에 자신의 IP 주소를 채워 ARP 요청을 보낸다.
  즉, ARP는 상대의 MAC 주소를 알아내기 위해 사용하는 반면, GARP는 자신의 IP와 MAC주소를 알릴 목적으로 사용된다.
- GARP를 이용해 동일 네트워크에 자신의 IP주소와 MAC주소를 알리는 이유
  1. IP 주소 충돌 감지
     - 어떠한 이유로 내가 할당받은 IP를 다른 사람이 사용하고 있을 수 있다.
       이것으로 인해 충돌나는걸 방지하기 위해 GARP를 이용해 이미 사용되고 있는지 확인한다.
     - GARP에서 응답이 오면 네트워크상에서 해당 IP를 이미 사용중이라는 뜻. (윈도우의 경우 충돌 에러 메세지를 내보내준다.)
  2. 상대방(동일 서브넷 상의 다른)의 ARP 테이블 갱신
  3. HA(고가용성) 용도의 클러스터링, VRRP, HSRP

#### RARP

- Reverse ARP
  말그대로 반대로 동작하는 ARP 이다.
- IP 주소가 정해져 있지 않은 단말이 IP 할당을 요청할 때 사용하는 방법이다.
